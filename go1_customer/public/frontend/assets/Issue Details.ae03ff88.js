var p=(g,y,n)=>new Promise((i,b)=>{var v=o=>{try{d(n.next(o))}catch(l){b(l)}},u=o=>{try{d(n.throw(o))}catch(l){b(l)}},d=o=>o.done?i(o.value):Promise.resolve(o.value).then(v,u);d((n=n.apply(g,y)).next())});import{_ as P,a as B}from"./AppHeader.0f924273.js";import{E as S,F as A,n as r,c as O,P as R,o as h,f as x,p as a,g as m,v as U,z as T,u as f,j as _,K as k,Y as F,a2 as H}from"./vendor.fd1dc2a4.js";import"./index.b49b7efc.js";const J={class:"flex h-screen w-screen"},K={class:"h-full border-r bg-gray-50"},M={class:"flex-1 flex flex-col h-full overflow-auto"},Y={class:"dashboard flex-1 overflow-auto px-28 py-10"},q={class:"bg-white border rounded-lg p-6 space-y-6 pb-[2.625rem]"},G={class:"float-left mb-1 text-9xl font-bold text-gray-800 -mt-2",style:{"font-size":"1.85rem"}},L={class:"text-9xl font-bold text-gray-600",style:{"font-size":"1rem"}},Q={class:"float-right mb-1"},W={class:"p-2"},X={key:0,class:"float-right flex gap-4"},ae={__name:"Issue Details",setup(g){const y=S(),n=A(),i=r(!1),b=r(""),v=r(""),u=r(""),d=r(""),o=r(""),l=r(""),E=r([]),j=r([]),V=O({url:"go1_customer.go1_customer.api.api.get_issues",method:"get"});r([{label:"Issues",route:{name:"issue"}},{label:"New",route:{}}]);const w=()=>p(this,null,function*(){try{const e=n.params.id,t=(yield V.fetch()).data;if(Array.isArray(t)){const c=t.find($=>$.name===e);c&&(b.value=c.name,l.value=c.subject,v.value=c.status,u.value=c.description.replace(/<\/?[^>]+>/gi,""),o.value=c.customer,d.value=c.priority)}}catch(e){console.error("Error fetching issue details:",e)}}),z=()=>{i.value=!0},C=()=>{i.value=!1,w()},D=()=>p(this,null,function*(){const e=n.params.id;if(!e)return;const s={subject:l.value,status:v.value,priority:d.value,description:u.value,customer:o.value};try{if(!(yield fetch(`/api/resource/Issue/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw new Error("Error updating issue");i.value=!1,y.push({name:"Issues"})}catch(t){console.error("Error updating issue:",t)}}),I=()=>p(this,null,function*(){try{const e=yield fetch('/api/resource/Customer?fields=["name"]');if(!e.ok)throw new Error("Network response was not ok");const s=yield e.json();E.value=s.data.map(t=>t.name)||[]}catch(e){console.error("Error fetching customers:",e)}}),N=()=>p(this,null,function*(){try{const e=yield fetch('/api/resource/Issue Priority?fields=["name"]');if(!e.ok)throw new Error("Network response was not ok");const s=yield e.json();j.value=s.data.map(t=>t.name)||[]}catch(e){console.error("Error fetching customers:",e)}});return R(()=>p(this,null,function*(){yield w(),yield I(),yield N()})),(e,s)=>(h(),x("div",J,[a("div",K,[m(P)]),a("div",M,[m(B),a("div",Y,[a("div",q,[a("div",G,[s[2]||(s[2]=a("p",null,"Issue",-1)),a("p",L,U(l.value),1)]),a("div",Q,[i.value?k("",!0):(h(),T(f(_),{key:0,variant:"solid",theme:"gray",size:"md",label:"Edit",disabled:!1,onClick:z}))]),s[4]||(s[4]=a("div",{class:"border-b pb-7 pt-8"},null,-1)),a("div",W,[m(f(F),{type:"text",size:"md",variant:"subtle",placeholder:"subject",disabled:!i.value,label:"Subject",modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=t=>l.value=t),class:"mb-5"},null,8,["disabled","modelValue"]),a("div",null,[s[3]||(s[3]=a("label",{class:"block text-base mb-2 text-gray-600",for:"frappe-ui-1"},"Description",-1)),m(f(H),{type:"textarea",size:"sm",variant:"subtle",placeholder:"Placeholder",disabled:!i.value,label:"Description",class:"mb-5 h-[200px]",modelValue:u.value,"onUpdate:modelValue":s[1]||(s[1]=t=>u.value=t)},null,8,["disabled","modelValue"])]),i.value?(h(),x("div",X,[m(f(_),{variant:"subtle",theme:"gray",size:"md",label:"Discard",disabled:!1,onClick:C}),m(f(_),{variant:"solid",theme:"gray",size:"md",label:"Submit",disabled:!1,onClick:D})])):k("",!0)])])])])]))}};export{ae as default};
