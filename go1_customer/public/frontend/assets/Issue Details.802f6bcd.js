var p=(y,b,c)=>new Promise((i,f)=>{var v=r=>{try{d(c.next(r))}catch(l){f(l)}},u=r=>{try{d(c.throw(r))}catch(l){f(l)}},d=r=>r.done?i(r.value):Promise.resolve(r.value).then(v,u);d((c=c.apply(y,b)).next())});import{_ as N,a as $}from"./AppHeader.1d5d11ab.js";import{Q as P,R,n,c as A,z as O,e as S,o as h,f as g,p as o,g as m,J as U,K as w,u as x,a1 as J,a4 as T}from"./vendor.8ee4b109.js";import"./index.c022bc80.js";const H={class:"flex h-screen w-screen"},K={class:"h-full border-r bg-gray-50"},M={class:"flex-1 flex flex-col h-full overflow-auto"},Q={class:"dashboard flex-1 overflow-auto px-28 py-10"},q={class:"bg-white border rounded-lg"},F={class:"flex border-b h-12 justify-between items-center p-6"},G={class:"p-6"},L={key:0,class:"flex justify-end gap-4 p-6"},ee={__name:"Issue Details",setup(y){const b=P(),c=R(),i=n(!1),f=n(""),v=n(""),u=n(""),d=n(""),r=n(""),l=n(""),k=n([]),j=n([]),E=A({url:"go1_customer.go1_customer.api.api.get_issues",method:"get"}),_=()=>p(this,null,function*(){try{const e=c.params.id,t=(yield E.fetch()).data;if(Array.isArray(t)){const a=t.find(B=>B.name===e);a&&(f.value=a.name,l.value=a.subject,v.value=a.status,u.value=a.description.replace(/<\/?[^>]+>/gi,""),r.value=a.customer,d.value=a.priority)}}catch(e){console.error("Error fetching issue details:",e)}}),C=()=>{i.value=!0},V=()=>{i.value=!1,_()},D=()=>p(this,null,function*(){const e=c.params.id;if(!e)return;const s={subject:l.value,status:v.value,priority:d.value,description:u.value,customer:r.value};try{if(!(yield fetch(`/api/resource/Issue/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw new Error("Error updating issue");i.value=!1,b.push({name:"Issues"})}catch(t){console.error("Error updating issue:",t)}}),I=()=>p(this,null,function*(){try{const e=yield fetch('/api/resource/Customer?fields=["name"]');if(!e.ok)throw new Error("Network response was not ok");const s=yield e.json();k.value=s.data.map(t=>t.name)||[]}catch(e){console.error("Error fetching customers:",e)}}),z=()=>p(this,null,function*(){try{const e=yield fetch('/api/resource/Issue Priority?fields=["name"]');if(!e.ok)throw new Error("Network response was not ok");const s=yield e.json();j.value=s.data.map(t=>t.name)||[]}catch(e){console.error("Error fetching customers:",e)}});return O(()=>p(this,null,function*(){yield _(),yield I(),yield z()})),(e,s)=>{const t=S("Button");return h(),g("div",H,[o("div",K,[m(N)]),o("div",M,[m($),o("div",Q,[o("div",q,[o("div",F,[s[2]||(s[2]=o("div",null,[o("p",{class:"text-9xl font-bold text-gray-800"},"Issue")],-1)),i.value?w("",!0):(h(),U(t,{key:0,variant:"solid",theme:"gray",size:"sm",label:"Edit",disabled:!1,onClick:C}))]),o("div",G,[m(x(J),{type:"text",size:"md",variant:"subtle",placeholder:"subject",disabled:!i.value,label:"Subject",modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=a=>l.value=a),class:"mb-5"},null,8,["disabled","modelValue"]),o("div",null,[s[3]||(s[3]=o("label",{class:"block text-base text-gray-600",for:"frappe-ui-1"},"Description",-1)),m(x(T),{type:"textarea",size:"sm",variant:"subtle",placeholder:"Placeholder",disabled:!i.value,label:"Description",class:"h-[200px]",modelValue:u.value,"onUpdate:modelValue":s[1]||(s[1]=a=>u.value=a)},null,8,["disabled","modelValue"])])]),o("div",null,[i.value?(h(),g("div",L,[m(t,{variant:"subtle",theme:"gray",size:"sm",label:"Discard",disabled:!1,onClick:V}),m(t,{variant:"solid",theme:"gray",size:"sm",label:"Submit",disabled:!1,onClick:D})])):w("",!0)])])])])])}}};export{ee as default};
